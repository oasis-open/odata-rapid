<!DOCTYPE html>
<html>
<head>
    <title>Test</title>
</head>
<body>
    <div class="input-group">
        <div id="editor" type="text" class="form-control"></div>
        <button id="send-button" class="btn btn-primary" type="button">
        Send
        </button>
    </div>
        <pre><code id="results" class="language-json"></code></pre>
    </div>
    <script src="dist/index.js"></script>
    <script>
        const jetsonsUrl = "https://jetsons.azurewebsites.net/";
        const metadataUrl = jetsonsUrl + "$metadata?$format=application/json";
        const editor = document.getElementById("editor");
        const sendButton = document.getElementById("send-button");
        const resultView = document.getElementById("results");
        const urlEditor = odataUriEditor.initUrlEditor(editor, (e) => {});
        fetch(metadataUrl)
            .then((response) => response.text()
            .then((text) => urlEditor.updateSchema(text, odataUriEditor.schemaFormat.jsonCsdl)));

        sendButton.addEventListener('click', async () => {
                fetch(jetsonsUrl + urlEditor.getUrl())
                .then((response) => response.text()
                .then((responseText)=>
                {
                    // TODO handle error responses
                    try {
                        const parsed = JSON.parse(responseText);
                        const pretty = JSON.stringify(parsed, null, 2);
                        responseText = pretty;
                    }
                    catch { }

                    resultView.innerHTML = responseText;
                }
            ))
        });
    </script>
</body>
</html>