"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[584],{5580:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>i,default:()=>h,frontMatter:()=>a,metadata:()=>o,toc:()=>d});var t=s(4246),r=s(1670);const a={id:"batch",title:"Batch Operations"},i=void 0,o={id:"spec/batch",title:"Batch Operations",description:"RAPID allows wrapping multiple requests into a single batch request.",source:"@site/../docs/spec/rapid-pro-batch.md",sourceDirName:"spec",slug:"/spec/batch",permalink:"/docs/spec/batch",draft:!1,unlisted:!1,editUrl:"https://github.com/oasis-open/odata-rapid/edit/main/docs/../docs/spec/rapid-pro-batch.md",tags:[],version:"current",frontMatter:{id:"batch",title:"Batch Operations"},sidebar:"docs",previous:{title:"Runtime Service Description",permalink:"/docs/spec/servicedescription"},next:{title:"RSDL Intro",permalink:"/docs/rsdl/rsdl-intro"}},c={},d=[{value:"Basics",id:"basics",level:2},{value:"Error Handling",id:"error-handling",level:2},{value:"Advanced Features",id:"advanced-features",level:2}];function l(e){const n={a:"a",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.p,{children:"RAPID allows wrapping multiple requests into a single batch request."}),"\n",(0,t.jsx)(n.h2,{id:"basics",children:"Basics"}),"\n",(0,t.jsxs)(n.p,{children:["Batch requests are sent to a special resource ",(0,t.jsx)(n.code,{children:"/$batch"}),".\nThe request payload consists of an array of individual requests,\nand the response payload consists of an array of individual responses.\nRequests and responses are correlated via an ",(0,t.jsx)(n.code,{children:"id"})," for each individual request."]}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Template"}),(0,t.jsx)(n.th,{style:{textAlign:"left"},children:"POST {service-root}/$batch"})]})}),(0,t.jsx)(n.tbody,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Example"})}),(0,t.jsxs)(n.td,{style:{textAlign:"left"},children:["POST ",(0,t.jsx)(n.a,{href:"http://rapid-pro.org/$batch",children:"http://rapid-pro.org/$batch"})]})]})})]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Body:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "requests": [\n    {\n      "id": "0",\n      "method": "get",\n      "url": "company"\n    },\n    {\n      "id": "1",\n      "method": "get",\n      "url": "competitors"\n    }\n  ]\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Result:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "responses": [\n    {\n      "id": "0",\n      "status": 200,\n      "body": {\n        "@context": "$metadata#company",\n        "name": "Spacely\'s Space Sprockets",\n        "stockSymbol": "spcly"\n      }\n    },\n    {\n      "id": "1",\n      "status": 200,\n      "body": {\n        "@context": "$metadata#competitors",\n        "value": [\n          {\n            "stockSymbol": "cgswl",\n            "name": "Cogswell\'s Cosmic COGs",\n            "incorporated": "2054-10-04T00:00:00Z"\n          }\n        ]\n      }\n    }\n  ]\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,t.jsxs)(n.p,{children:["Batch requests return ",(0,t.jsx)(n.code,{children:"200 OK"})," even if some or all of the individual requests in the batch fail.\nBatch requests only return ",(0,t.jsx)(n.code,{children:"4xx"})," if the batch request body is malformed,\nthe client is not authenticated or lacks authorization for the ",(0,t.jsx)(n.code,{children:"/$batch"})," resource,\nor other reasons not related to individual requests in the batch."]}),"\n",(0,t.jsx)(n.p,{children:"If an individual request fails, processing continues with the next request.\nIndividual requests can be processed in any order,\nnot necessarily in the sequence they appear in the batch request."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Body:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "requests": [\n    {\n      "id": "p-0",\n      "method": "patch",\n      "url": "company/employees/2",\n      "headers": {\n        "if-match": "MjA2My0wNC0wMVQxMzo1NToyNy4xMjM0NTZa"\n      },\n      "body": {\n        "title": "On garden leave"\n      }\n    },\n    {\n      "id": "p-1",\n      "method": "patch",\n      "url": "company/employees/4",\n      "body": {\n        "title": "Junior Digital Index Operator"\n      }\n    }\n  ]\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Result (some individual requests succeed, some fail):"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "responses": [\n    {\n      "id": "p-0",\n      "status": 412,\n      "body": {\n        "error": {\n          "code": "INVALID_ETAG",\n          "message": "The ETag provided in the If-Match header was outdated"\n        }\n      }\n    },\n    {\n      "id": "p-1",\n      "status": 204\n    }\n  ]\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"advanced-features",children:"Advanced Features"}),"\n",(0,t.jsx)(n.p,{children:"Batch requests can be enhanced in many ways:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Execute individual requests only if preceding requests in the same batch request succeed or fail"}),"\n",(0,t.jsx)(n.li,{children:"Reference the result of preceding requests"}),"\n",(0,t.jsx)(n.li,{children:"Execute batch requests asynchronously and return individual results as soon as they are available"}),"\n",(0,t.jsx)(n.li,{children:"Group operations into atomicity groups that are executed all-or-nothing"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["See ",(0,t.jsx)(n.a,{href:"https://docs.oasis-open.org/odata/odata-json-format/v4.01/odata-json-format-v4.01.html#sec_BatchRequestsandResponses",children:"Batch Requests and Responses"})," for details."]})]})}function h(e={}){const{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}},1670:(e,n,s)=>{s.d(n,{Z:()=>o,a:()=>i});var t=s(7378);const r={},a=t.createContext(r);function i(e){const n=t.useContext(a);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),t.createElement(a.Provider,{value:n},e.children)}}}]);