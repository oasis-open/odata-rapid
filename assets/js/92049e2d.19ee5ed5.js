/*! For license information please see 92049e2d.19ee5ed5.js.LICENSE.txt */
"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[584],{2525:function(e){var t=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;function o(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(e){r[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(o){return!1}}()?Object.assign:function(e,a){for(var i,s,c=o(e),l=1;l<arguments.length;l++){for(var u in i=Object(arguments[l]))n.call(i,u)&&(c[u]=i[u]);if(t){s=t(i);for(var p=0;p<s.length;p++)r.call(i,s[p])&&(c[s[p]]=i[s[p]])}}return c}},1535:function(e,t,n){var r=n(2525),o="function"==typeof Symbol&&Symbol.for,a=o?Symbol.for("react.element"):60103,i=o?Symbol.for("react.portal"):60106,s=o?Symbol.for("react.fragment"):60107,c=o?Symbol.for("react.strict_mode"):60108,l=o?Symbol.for("react.profiler"):60114,u=o?Symbol.for("react.provider"):60109,p=o?Symbol.for("react.context"):60110,f=o?Symbol.for("react.forward_ref"):60112,d=o?Symbol.for("react.suspense"):60113,y=o?Symbol.for("react.memo"):60115,m=o?Symbol.for("react.lazy"):60116,h="function"==typeof Symbol&&Symbol.iterator;function b(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g={};function k(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||v}function O(){}function j(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||v}k.prototype.isReactComponent={},k.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error(b(85));this.updater.enqueueSetState(this,e,t,"setState")},k.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},O.prototype=k.prototype;var w=j.prototype=new O;w.constructor=j,r(w,k.prototype),w.isPureReactComponent=!0;var N={current:null},S=Object.prototype.hasOwnProperty,q={key:!0,ref:!0,__self:!0,__source:!0};function x(e,t,n){var r,o={},i=null,s=null;if(null!=t)for(r in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(i=""+t.key),t)S.call(t,r)&&!q.hasOwnProperty(r)&&(o[r]=t[r]);var c=arguments.length-2;if(1===c)o.children=n;else if(1<c){for(var l=Array(c),u=0;u<c;u++)l[u]=arguments[u+2];o.children=l}if(e&&e.defaultProps)for(r in c=e.defaultProps)void 0===o[r]&&(o[r]=c[r]);return{$$typeof:a,type:e,key:i,ref:s,props:o,_owner:N.current}}function P(e){return"object"==typeof e&&null!==e&&e.$$typeof===a}var E=/\/+/g,C=[];function T(e,t,n,r){if(C.length){var o=C.pop();return o.result=e,o.keyPrefix=t,o.func=n,o.context=r,o.count=0,o}return{result:e,keyPrefix:t,func:n,context:r,count:0}}function R(e){e.result=null,e.keyPrefix=null,e.func=null,e.context=null,e.count=0,10>C.length&&C.push(e)}function $(e,t,n,r){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var s=!1;if(null===e)s=!0;else switch(o){case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case a:case i:s=!0}}if(s)return n(r,e,""===t?"."+M(e,0):t),1;if(s=0,t=""===t?".":t+":",Array.isArray(e))for(var c=0;c<e.length;c++){var l=t+M(o=e[c],c);s+=$(o,l,n,r)}else if(null===e||"object"!=typeof e?l=null:l="function"==typeof(l=h&&e[h]||e["@@iterator"])?l:null,"function"==typeof l)for(e=l.call(e),c=0;!(o=e.next()).done;)s+=$(o=o.value,l=t+M(o,c++),n,r);else if("object"===o)throw n=""+e,Error(b(31,"[object Object]"===n?"object with keys {"+Object.keys(e).join(", ")+"}":n,""));return s}function D(e,t,n){return null==e?0:$(e,"",t,n)}function M(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+(""+e).replace(/[=:]/g,(function(e){return t[e]}))}(e.key):t.toString(36)}function A(e,t){e.func.call(e.context,t,e.count++)}function B(e,t,n){var r=e.result,o=e.keyPrefix;e=e.func.call(e.context,t,e.count++),Array.isArray(e)?I(e,r,n,(function(e){return e})):null!=e&&(P(e)&&(e=function(e,t){return{$$typeof:a,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(e,o+(!e.key||t&&t.key===e.key?"":(""+e.key).replace(E,"$&/")+"/")+n)),r.push(e))}function I(e,t,n,r,o){var a="";null!=n&&(a=(""+n).replace(E,"$&/")+"/"),D(e,B,t=T(t,a,r,o)),R(t)}var _={current:null};function U(){var e=_.current;if(null===e)throw Error(b(321));return e}},7378:function(e,t,n){n(1535)},3905:function(e,t,n){n.d(t,{Zo:function(){return u},kt:function(){return d}});var r=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var c=r.createContext({}),l=function(e){var t=r.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},u=function(e){var t=l(e.components);return r.createElement(c.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},f=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,c=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),f=l(n),d=o,y=f["".concat(c,".").concat(d)]||f[d]||p[d]||a;return n?r.createElement(y,i(i({ref:t},u),{},{components:n})):r.createElement(y,i({ref:t},u))}));function d(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,i=new Array(a);i[0]=f;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s.mdxType="string"==typeof e?e:o,i[1]=s;for(var l=2;l<a;l++)i[l]=n[l];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}f.displayName="MDXCreateElement"},950:function(e,t,n){n.r(t),n.d(t,{assets:function(){return u},contentTitle:function(){return c},default:function(){return d},frontMatter:function(){return s},metadata:function(){return l},toc:function(){return p}});var r=n(7462),o=n(3366),a=(n(7378),n(3905)),i=["components"],s={id:"batch",title:"Batch Operations"},c=void 0,l={unversionedId:"spec/batch",id:"spec/batch",title:"Batch Operations",description:"RAPID allows wrapping multiple requests into a single batch request.",source:"@site/../docs/spec/rapid-pro-batch.md",sourceDirName:"spec",slug:"/spec/batch",permalink:"/docs/spec/batch",draft:!1,editUrl:"https://github.com/oasis-open/odata-rapid/edit/main/docs/../docs/spec/rapid-pro-batch.md",tags:[],version:"current",frontMatter:{id:"batch",title:"Batch Operations"},sidebar:"docs",previous:{title:"Runtime Service Description",permalink:"/docs/spec/servicedescription"},next:{title:"RSDL Intro",permalink:"/docs/rsdl/rsdl-intro"}},u={},p=[{value:"Basics",id:"basics",level:2},{value:"Error Handling",id:"error-handling",level:2},{value:"Advanced Features",id:"advanced-features",level:2}],f={toc:p};function d(e){var t=e.components,n=(0,o.Z)(e,i);return(0,a.kt)("wrapper",(0,r.Z)({},f,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"RAPID allows wrapping multiple requests into a single batch request."),(0,a.kt)("h2",{id:"basics"},"Basics"),(0,a.kt)("p",null,"Batch requests are sent to a special resource ",(0,a.kt)("inlineCode",{parentName:"p"},"/$batch"),".\nThe request payload consists of an array of individual requests,\nand the response payload consists of an array of individual responses.\nRequests and responses are correlated via an ",(0,a.kt)("inlineCode",{parentName:"p"},"id")," for each individual request."),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"Template"),(0,a.kt)("th",{parentName:"tr",align:"left"},"POST {service-root}/\\$batch"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("strong",{parentName:"td"},"Example")),(0,a.kt)("td",{parentName:"tr",align:"left"},"POST ",(0,a.kt)("a",{parentName:"td",href:"http://rapid-pro.org/$batch"},"http://rapid-pro.org/$batch"))))),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Body:")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "requests": [\n    {\n      "id": "0",\n      "method": "get",\n      "url": "company"\n    },\n    {\n      "id": "1",\n      "method": "get",\n      "url": "competitors"\n    }\n  ]\n}\n')),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Result:")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "responses": [\n    {\n      "id": "0",\n      "status": 200,\n      "body": {\n        "@context": "$metadata#company",\n        "name": "Spacely\'s Space Sprockets",\n        "stockSymbol": "spcly"\n      }\n    },\n    {\n      "id": "1",\n      "status": 200,\n      "body": {\n        "@context": "$metadata#competitors",\n        "value": [\n          {\n            "stockSymbol": "cgswl",\n            "name": "Cogswell\'s Cosmic COGs",\n            "incorporated": "2054-10-04T00:00:00Z"\n          }\n        ]\n      }\n    }\n  ]\n}\n')),(0,a.kt)("h2",{id:"error-handling"},"Error Handling"),(0,a.kt)("p",null,"Batch requests return ",(0,a.kt)("inlineCode",{parentName:"p"},"200 OK")," even if some or all of the individual requests in the batch fail.\nBatch requests only return ",(0,a.kt)("inlineCode",{parentName:"p"},"4xx")," if the batch request body is malformed,\nthe client is not authenticated or lacks authorization for the ",(0,a.kt)("inlineCode",{parentName:"p"},"/$batch")," resource,\nor other reasons not related to individual requests in the batch."),(0,a.kt)("p",null,"If an individual request fails, processing continues with the next request.\nIndividual requests can be processed in any order,\nnot necessarily in the sequence they appear in the batch request."),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Body:")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "requests": [\n    {\n      "id": "p-0",\n      "method": "patch",\n      "url": "company/employees/2",\n      "headers": {\n        "if-match": "MjA2My0wNC0wMVQxMzo1NToyNy4xMjM0NTZa"\n      },\n      "body": {\n        "title": "On garden leave"\n      }\n    },\n    {\n      "id": "p-1",\n      "method": "patch",\n      "url": "company/employees/4",\n      "body": {\n        "title": "Junior Digital Index Operator"\n      }\n    }\n  ]\n}\n')),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Result (some individual requests succeed, some fail):")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "responses": [\n    {\n      "id": "p-0",\n      "status": 412,\n      "body": {\n        "error": {\n          "code": "INVALID_ETAG",\n          "message": "The ETag provided in the If-Match header was outdated"\n        }\n      }\n    },\n    {\n      "id": "p-1",\n      "status": 204\n    }\n  ]\n}\n')),(0,a.kt)("h2",{id:"advanced-features"},"Advanced Features"),(0,a.kt)("p",null,"Batch requests can be enhanced in many ways:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Execute individual requests only if preceding requests in the same batch request succeed or fail"),(0,a.kt)("li",{parentName:"ul"},"Reference the result of preceding requests"),(0,a.kt)("li",{parentName:"ul"},"Execute batch requests asynchronously and return individual results as soon as they are available"),(0,a.kt)("li",{parentName:"ul"},"Group operations into atomicity groups that are executed all-or-nothing")),(0,a.kt)("p",null,"See ",(0,a.kt)("a",{parentName:"p",href:"https://docs.oasis-open.org/odata/odata-json-format/v4.01/odata-json-format-v4.01.html#sec_BatchRequestsandResponses"},"Batch Requests and Responses")," for details."))}d.isMDXComponent=!0}}]);